<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title> • Development Environment</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="highlight/atom-one-dark.css" /><script type="text/javascript" src="highlight/highlight.pack.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a> with the <a href="https://github.com/clojang/codox-theme">Clojang UI</a> theme</h2><h1><a href="index.html"><span class="project-title"><span class="project-name">CMR Graph</span> <span class="project-version">0.1.0-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="0500-setup.html"><div class="inner"><span>Setup</span></div></a></li><li class="depth-1 "><a href="0750-connecting.html"><div class="inner"><span>Connecting</span></div></a></li><li class="depth-1 "><a href="1000-usage.html"><div class="inner"><span>Usage</span></div></a></li><li class="depth-1 "><a href="2000-dev.html"><div class="inner"><span>Development</span></div></a></li><li class="depth-1  current"><a href="2100-dev-env.html"><div class="inner"><span> • Development Environment</span></div></a></li><li class="depth-1 "><a href="2500-dev-plans.html"><div class="inner"><span> • Development Plans</span></div></a></li><li class="depth-1 "><a href="7000-deploying.html"><div class="inner"><span>Deploying with CMR</span></div></a></li><li class="depth-1 "><a href="9800-marginalia.html"><div class="inner"><span>Marginalia</span></div></a></li><li class="depth-1 "><a href="9999-other-versions.html"><div class="inner"><span>Other Versions</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>cmr</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>graph</span></div></div></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>collections</span></div></div></li><li class="depth-4"><a href="cmr.graph.collections.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>components</span></div></div></li><li class="depth-4 branch"><a href="cmr.graph.components.config.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>config</span></div></a></li><li class="depth-4 branch"><a href="cmr.graph.components.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-4 branch"><a href="cmr.graph.components.elastic.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>elastic</span></div></a></li><li class="depth-4 branch"><a href="cmr.graph.components.httpd.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>httpd</span></div></a></li><li class="depth-4 branch"><a href="cmr.graph.components.logging.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>logging</span></div></a></li><li class="depth-4"><a href="cmr.graph.components.neo4j.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>neo4j</span></div></a></li><li class="depth-3 branch"><a href="cmr.graph.config.html"><div class="inner"><span class="tree" style="top: -207px;"><span class="top" style="height: 216px;"></span><span class="bottom"></span></span><span>config</span></div></a></li><li class="depth-3 branch"><a href="cmr.graph.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>data</span></div></div></li><li class="depth-4 branch"><a href="cmr.graph.data.import.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>import</span></div></a></li><li class="depth-4 branch"><a href="cmr.graph.data.statement.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>statement</span></div></a></li><li class="depth-4"><a href="cmr.graph.data.tags.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tags</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree" style="top: -114px;"><span class="top" style="height: 123px;"></span><span class="bottom"></span></span><span>demo</span></div></div></li><li class="depth-4"><a href="cmr.graph.demo.movie.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>movie</span></div></a></li><li class="depth-3 branch"><a href="cmr.graph.health.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>health</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>queries</span></div></div></li><li class="depth-4"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>neo4j</span></div></div></li><li class="depth-5 branch"><a href="cmr.graph.queries.neo4j.collections.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>collections</span></div></a></li><li class="depth-5"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>demo</span></div></div></li><li class="depth-6"><a href="cmr.graph.queries.neo4j.demo.movie.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>movie</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>rest</span></div></div></li><li class="depth-4 branch"><a href="cmr.graph.rest.app.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>app</span></div></a></li><li class="depth-4 branch"><a href="cmr.graph.rest.handler.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>handler</span></div></a></li><li class="depth-4 branch"><a href="cmr.graph.rest.middleware.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>middleware</span></div></a></li><li class="depth-4 branch"><a href="cmr.graph.rest.response.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>response</span></div></a></li><li class="depth-4"><a href="cmr.graph.rest.route.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>route</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree" style="top: -176px;"><span class="top" style="height: 185px;"></span><span class="bottom"></span></span><span>system</span></div></div></li><li class="depth-4 branch"><a href="cmr.graph.system.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-4"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>impl</span></div></div></li><li class="depth-5 branch"><a href="cmr.graph.system.impl.management.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>management</span></div></a></li><li class="depth-5"><a href="cmr.graph.system.impl.state.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>state</span></div></a></li></ul></div><div class="document" id="content"><div class="doc"><div class="markdown"><h1><a href="#development-environment" name="development-environment"></a> • Development Environment</h1>
<p><strong>Contents</strong></p>
<ul>
  <li>nREPL</li>
  <li>Proto-REPL</li>
  <li>System</li>
  <li>Code Reloading</li>
  <li>Convenience Functions</li>
</ul>
<h2><a href="#nrepl" name="nrepl"></a>nREPL</h2>
<p>To write new code for CMR Graph, you’ll need to have the infrastructure running as described in the “Setup” docs, and then you’ll want to start up a REPL. The primary development REPL for CMR Graph is a terminal-based nREPL:</p>
<pre><code>$ lein repl
</code></pre>
<pre><code class="text">               ____
            ,dP9CGG88@b,
          ,IIIIYICCG888@@b,
         dIIIIIIIICGG8888@b
        dCIIIIIIICCGG8888@@b
        GCCIIIICCCGGG8888@@@
        GGCCCCCCCGGG88888@@@
        GGGGCCCGGGG88888@@@@\
        Y8GGGGGG8888888@@@@P \
         Y88888888888@@@@@P \ \
         `Y8888888@@@@@@@P   \  \
           |`@@@@@@@@@P'      \  \
           | .  """"           \   \       _....___
           ' .                   \   \  .d$#T!!!~"#*b.
           ' |                    \   d$MM!!!!~~~     "h
           " |                     \dRMMM!!!~           ^k
           = "                     $RMM!!~                .__
  ____   ____________            ________________  ______ |  |__
_/ ___\ /     \_  __ \  ______  / ___\_  __ \__  \ \____ \|  |  \
\  \___|  Y Y  \  | \/ /_____/ / /_/  &gt;  | \// __ \|  |_&gt; &gt;   Y  \
 \___  &gt;__|_|  /__|            \___  /|__|  (____  /   __/|___|  /
     \/      \/            __ /_____/            \/|__|        \/
      .X+.   .      ___----     'k~~                        :
    .Xx+-.     . '''  ____----""" 3&gt;                        F
    XXx++-..     --'''            9&gt;                       F
    XXxx++--..                     "i                    :"
    `XXXxx+++--'                     t.                .P
      `XXXxxx'                         #c.          .z#
         ``                               ^#*heee*#"


nREPL server started on port 53287 on host 127.0.0.1 - nrepl://127.0.0.1:53287
REPL-y 0.3.7, nREPL 0.2.12
Clojure 1.9.0
Java HotSpot(TM) 64-Bit Server VM 1.8.0_161-b12
    Docs: (doc function-name-here)
          (find-doc "part-of-name-here")
  Source: (source function-name-here)
 Javadoc: (javadoc java-object-or-class-here)
    Exit: Control+D or (exit) or (quit)
 Results: Stored in vars *1, *2, *3, an exception in *e

[cmr.graph.dev] λ=&gt;
</code></pre>
<h2><a href="#proto-repl" name="proto-repl"></a>Proto-REPL</h2>
<p>For those using the Atom editor, CMR Graph also offers support for Proto-REPL. To this end, the <code>user</code> ns has been provied at <code>dev-resources/src/user.clj</code>. It is essentially a wrapper for <code>cmr.graph.dev</code> (and can be removed once Proto-REPL supports configurable starting namespaces, as <code>lein</code> does).</p>
<h2><a href="#system" name="system"></a>System</h2>
<p>With the REPL up, you’re ready to bring up the CMR Graph system components:</p>
<pre><code class="clj">[cmr.graph.dev] λ=&gt; (startup)
</code></pre>
<p>This will start the following CMR Graph components:</p>
<ul>
  <li>Configuration</li>
  <li>Logging</li>
  <li>A Neo4j connection</li>
  <li>An Elasticsearch connection</li>
  <li>The CMR Graph HTTP server for the REST API</li>
</ul>
<p>as the log messages show:</p>
<pre><code>2018-03-09T17:13:42.947 [nREPL-worker-0] INFO c.g.c.config:35 - Starting config component ...
2018-03-09T17:13:42.987 [nREPL-worker-0] INFO c.g.c.logging:22 - Starting logging component ...
2018-03-09T17:13:42.988 [nREPL-worker-0] INFO c.g.c.neo4j:21 - Starting Neo4j component ...
2018-03-09T17:13:42.992 [nREPL-worker-0] INFO c.g.c.elastic:21 - Starting Elasticsearch component ...
2018-03-09T17:13:42.993 [nREPL-worker-0] INFO c.g.c.httpd:22 - Starting httpd component ...
</code></pre>
<p>A convenience function has been provided for use in the REPL which returns the dynamic var where the system state is stored:</p>
<pre><code class="clj">[cmr.graph.dev] λ=&gt; (system)
</code></pre>
<p>When you’re done, you can shutdown the system and all of its components with this:</p>
<pre><code class="clj">[cmr.graph.dev] λ=&gt; (shutdown)
</code></pre>
<h2><a href="#code-reloading" name="code-reloading"></a>Code Reloading</h2>
<p>You can reload changed code in the REPL without leaving it.</p>
<p>If you don’t have a running system, the quickest way to do this is with <code>refresh</code>. However, this should not be used with a running system.</p>
<p>If you have starte the system, then you’ll want to use <code>reset</code>. This stops a running system, reloads the changed namespaces, and then restarts the system.</p>
<h2><a href="#convenience-functions" name="convenience-functions"></a>Convenience Functions</h2>
<p>Convenience wrappers have been provided for several CMR Graph API functions in the REPL dev namespaces, automatically pulling the information they require (e.g., Neo4j conection data) from the system data structure:</p>
<pre><code class="clj">[cmr.graph.dev] λ=&gt; (pprint (search-movie "Matr"))
({:movie
  {:tagline "Welcome to the Real World",
   :title "The Matrix",
   :released 1999}}
 {:movie
  {:tagline "Free your mind",
   :title "The Matrix Reloaded",
   :released 2003}}
 {:movie
  {:tagline "Everything that has a beginning has an end",
   :title "The Matrix Revolutions",
   :released 2003}})
nil
</code></pre>
<pre><code class="clj">[cmr.graph.dev] λ=&gt; (pprint (get-movie "The Matrix"))
{"title" "The Matrix",
 "cast"
 [{:role ["Emil"], :name "Emil Eifrem", :job "acted"}
  {:role nil, :name "Joel Silver", :job "produced"}
  {:role nil, :name "Lana Wachowski", :job "directed"}
  {:role nil, :name "Lilly Wachowski", :job "directed"}
  {:role ["Agent Smith"], :name "Hugo Weaving", :job "acted"}
  {:role ["Morpheus"], :name "Laurence Fishburne", :job "acted"}
  {:role ["Trinity"], :name "Carrie-Anne Moss", :job "acted"}
  {:role ["Neo"], :name "Keanu Reeves", :job "acted"}]}
nil
</code></pre>
<pre><code class="clj">[cmr.graph.dev] λ=&gt; (pprint (get-movie-graph 100))
{:nodes
 ({:title "Apollo 13", :label :movie}
  {:title "Tom Hanks", :label :actor}
  {:title "Kevin Bacon", :label :actor}
  ...)
 :links
 ({:target 0, :source 1}
  {:target 0, :source 2}
  {:target 0, :source 3})}
nil
</code></pre>
<p>Additional convenience functions provided in the <code>cmr.graph.dev</code> namespace, for use in the REPL:</p>
<ul>
  <li><code>banner</code></li>
  <li><code>current-health</code></li>
  <li><code>refresh</code></li>
  <li><code>reset</code></li>
</ul>
<!-- Named page links below: /--></div></div></div></body></html>