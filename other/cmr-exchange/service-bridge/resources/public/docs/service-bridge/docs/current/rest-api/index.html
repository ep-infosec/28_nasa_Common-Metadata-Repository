
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>CMR Service-Bridge REST API Documentation</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="https://cdn.earthdata.nasa.gov/eui/1.1.3/stylesheets/application.css"
          rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700,300"
          rel="stylesheet"
          type="text/css">
    <link href="https://cmr.sit.earthdata.nasa.gov/service-bridge/site/css/eui.css"
          rel="stylesheet" />
    <link href="https://cmr.sit.earthdata.nasa.gov/service-bridge/site/css/cmr.css"
          rel="stylesheet" />
    <link href="rest-api/stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="rest-api/stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="rest-api/javascripts/all.js"></script>

    <script src="https://cdn.earthdata.nasa.gov/tophat2/tophat2.js"
            id="earthdata-tophat-script"
            data-show-fbm="true"
            data-show-status="true"
            data-status-api-url="https://status.earthdata.nasa.gov/api/v1/notifications"
            data-status-polling-interval="10">
    </script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;,&quot;javascript&quot;,&quot;clojure&quot;]">

    <header class="doc-mast">
      <div class="container">
        <div class="eui-masthead-logo eui-application-logo">
          <h1><a href="https://cmr.sit.earthdata.nasa.gov/service-bridge/">CMR Service-Bridge</a></h1>
        </div>
        <nav class="main-nav" role="navigation">
          <ul class="main-nav-list">

          <li><a href="https://cmr.sit.earthdata.nasa.gov/service-bridge/docs">Documentation</a></li>


            <li><a href="https://wiki.earthdata.nasa.gov/display/CMR/Common+Metadata+Repository+Home">Wiki</a></li>
            <li><a href="https://wiki.earthdata.nasa.gov/display/CMR/CMR+Client+Partner+User+Guide">Client Partner&#39;s Guide</a></li>
            <li><a href="https://github.com/nasa/Common-Metadata-Repository">Github</a></li>
          </ul>
        </nav>
      </div>
    </header>

    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="rest-api/images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
        <div class="lang-selector">
              <a href="#" data-language-name="shell">shell</a>
              <a href="#" data-language-name="javascript">javascript</a>
              <a href="#" data-language-name="clojure">clojure</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc" class="toc-list-h1">
          <li>
            <a href="#rest-api-overview" class="toc-h1 toc-link" data-title="rest-api-overview">REST API Overview</a>
          </li>
          <li>
            <a href="#about-the-docs" class="toc-h1 toc-link" data-title="about-the-docs">About the Docs</a>
          </li>
          <li>
            <a href="#releases" class="toc-h1 toc-link" data-title="releases">Releases</a>
          </li>
          <li>
            <a href="#versioned-api" class="toc-h1 toc-link" data-title="versioned-api">Versioned API</a>
          </li>
          <li>
            <a href="#authorized-access" class="toc-h1 toc-link" data-title="authorized-access">Authorized Access</a>
          </li>
          <li>
            <a href="#responses" class="toc-h1 toc-link" data-title="responses">Responses</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#success" class="toc-h2 toc-link" data-title="success">Success</a>
                  </li>
                  <li>
                    <a href="#request-ids" class="toc-h2 toc-link" data-title="request-ids">Request IDs</a>
                  </li>
                  <li>
                    <a href="#errors" class="toc-h2 toc-link" data-title="errors">Errors</a>
                  </li>
                  <li>
                    <a href="#warnings" class="toc-h2 toc-link" data-title="warnings">Warnings</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#ous-resources" class="toc-h1 toc-link" data-title="ous-resources">OUS Resources</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#tag-associations" class="toc-h2 toc-link" data-title="tag-associations">Tag Associations</a>
                  </li>
                  <li>
                    <a href="#collection-resources" class="toc-h2 toc-link" data-title="collection-resources">Collection Resources</a>
                  </li>
                  <li>
                    <a href="#interaction-of-parameters" class="toc-h2 toc-link" data-title="interaction-of-parameters">Interaction of Parameters</a>
                  </li>
                  <li>
                    <a href="#cmr-style-parameters" class="toc-h2 toc-link" data-title="cmr-style-parameters">CMR-Style Parameters</a>
                  </li>
                  <li>
                    <a href="#wcs-style-parameters" class="toc-h2 toc-link" data-title="wcs-style-parameters">WCS-Style Parameters</a>
                  </li>
                  <li>
                    <a href="#forthcoming" class="toc-h2 toc-link" data-title="forthcoming">Forthcoming</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#ses-resources" class="toc-h1 toc-link" data-title="ses-resources">SES Resources</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#collection-resources-2" class="toc-h2 toc-link" data-title="collection-resources">Collection Resources</a>
                  </li>
                  <li>
                    <a href="#parameters" class="toc-h2 toc-link" data-title="parameters">Parameters</a>
                  </li>
                  <li>
                    <a href="#examples" class="toc-h2 toc-link" data-title="examples">Examples</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#admin-resources" class="toc-h1 toc-link" data-title="admin-resources">Admin Resources</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#cache" class="toc-h2 toc-link" data-title="cache">Cache</a>
                  </li>
                  <li>
                    <a href="#health" class="toc-h2 toc-link" data-title="health">Health</a>
                  </li>
                  <li>
                    <a href="#ping" class="toc-h2 toc-link" data-title="ping">Ping</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#testing-resources" class="toc-h1 toc-link" data-title="testing-resources">Testing Resources</a>
          </li>
          <li>
            <a href="#errors-messages" class="toc-h1 toc-link" data-title="errors-messages">Errors Messages</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#dependent-services" class="toc-h2 toc-link" data-title="dependent-services">Dependent Services</a>
                  </li>
                  <li>
                    <a href="#cmr-service-bridge-warnings" class="toc-h2 toc-link" data-title="cmr-service-bridge-warnings">CMR Service-Bridge Warnings</a>
                  </li>
                  <li>
                    <a href="#cmr-service-bridge-errors" class="toc-h2 toc-link" data-title="cmr-service-bridge-errors">CMR Service-Bridge Errors</a>
                  </li>
              </ul>
          </li>
      </div>
        <ul class="toc-footer">
            <li><a href='https://github.com/lord/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='rest-api-overview'>REST API Overview</h1>
<p>The REST API for CMR Service-Bridge aims to accomplish a few core goals:</p>

<ul>
<li>Provide a straight forward means of bridging the CMR and various service
deployments</li>
<li>Provide operational insights into the CMR Service-Bridge REST service itself</li>
<li>Do both of these as simply and in as scalable a manner as possible</li>
</ul>

<p>The REST API is currently focused on the following:
* generating OPeNDAP data access URLs, and
* providing size estimates for subsetted GIS data</p>

<p>The first allows users to easily download subsetted files from OPeNDAP servers
based on metadata stored in the CMR and presented to end users by EDSC.
The second provides users with the ability to see what the total estimated size
of their data request would be. This will give users the necessary feedback
on whether the total of their subsetted data is too large, too small, or just
right.</p>
<h1 id='about-the-docs'>About the Docs</h1>
<p>This API documentation provides prose in the central column, using
the left column to highlight usage and code.</p>

<p>Note that, due to some of the long URLs and query examples, the lines
in the examples are broken up -- this is done for the sake of visiability
on the page. When you use these to make a query you must remove newline
breaks.</p>

<aside class="error">
  In many cases, copying and pasting the examples as-is will not work!
  Line separations have been added to the examples for visual clarity; to
  actually use these, you need to make sure extraneous newlines have been
  removed.
</aside>

<aside class="warning">
  The concept ids for collections, variables, granules, etc., used in the
  examples below could very well have changed since this documentation
  was first created, or you may be using the service in a different
  environment (which would have different concept ids). Be sure to use
  the concept ids that you know exist in your target environment.
</aside>
<h1 id='releases'>Releases</h1>
<p>The following table provides a mapping between CMR Service-Bridge releases
and the API versions supported in each.</p>

<table><thead>
<tr>
<th>Release</th>
<th>REST API Versions</th>
<th>Status</th>
</tr>
</thead><tbody>
<tr>
<td>1.6.0-SNAPSHOT</td>
<td>v1, v2, v2.1, v3</td>
<td>In development</td>
</tr>
<tr>
<td>1.1.0 through 1.5.0</td>
<td>v1, v2, v2.1</td>
<td>Released</td>
</tr>
<tr>
<td>1.0.0</td>
<td>v1, v2</td>
<td>Released</td>
</tr>
<tr>
<td>0.1.0</td>
<td>v1</td>
<td>Released</td>
</tr>
</tbody></table>

<p>Summary of changes in REST API:</p>

<ul>
<li>v3: Changed default format to DAP4; Added dap-version parameter</li>
<li>v2.1: Use of UMM-Var 1.2 new dimensional metadata to remove old hacks</li>
<li>v2: Breaking change to cache management admin resource</li>
<li>v1: First version of API (including admin resources)</li>
</ul>
<h1 id='versioned-api'>Versioned API</h1>
<p>The CMR Service-Bridge REST API is versioned. By default, the most recent version of
the API is accessed when a request is submitted without specifying the
desired version. Currently, this is <code>v3</code>.</p>

<p>To request a specific version of the REST API, you must send an additional
header in your request to CMR Service-Bridge.</p>

<blockquote>
<p>An <code>Accept</code> header is required to request a specific version of the API:</p>
</blockquote>
<pre class="highlight plaintext"><code>"Accept: application/vnd.cmr-service-bridge.v2+json"
</code></pre>
<blockquote>
<p>The following is also valid:</p>
</blockquote>
<pre class="highlight plaintext"><code>"Accept: application/vnd.cmr-service-bridge.v2"
</code></pre>
<p>All HTTP responses from the REST API also provide information on the version
used when processing the request. This can be useful for clients debugging
calls to the service.</p>

<blockquote>
<p>Examine the headers with a call to the service:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -i ...
</code></pre><pre class="highlight clojure"><code><span class="p">(</span><span class="nf">request/get</span><span class="w"> </span><span class="n">...</span><span class="p">)</span><span class="w">
</span></code></pre>
<blockquote>
<p>The response headers will include the version used by the service:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>Cmr-Media-Type: cmr-service-bridge.v2; <span class="nv">format</span><span class="o">=</span>json
</code></pre><pre class="highlight clojure"><code><span class="p">{</span><span class="n">...</span><span class="w">
 </span><span class="no">:cmr-media-type</span><span class="w"> </span><span class="s">"cmr-service-bridge.v2; format=json"</span><span class="w">
 </span><span class="n">...</span><span class="p">}</span><span class="w">
</span></code></pre>
<aside class="warning">
  The most recent release of the CMR Service-Bridge API is always the default;
  if you experience unexpected issues and/or errors, this may be a result
  of using a new version of the API by default.
</aside>

<aside class="info">
  We recommend explicitly "pinning" your client requests to the latest
  release of the API so that you are always using exactly what you expect
  to be using. Then your use of new versions of the API will be an intentional decision.
</aside>
<h1 id='authorized-access'>Authorized Access</h1>
<p>CMR Service-Bridge requires the use of tokens in order to provide access to
potentially protected collections, services, variables, and/or granules.</p>

<blockquote>
<p>A token needs to be included in each request, and this is done by sending a special header:</p>
</blockquote>
<pre class="highlight plaintext"><code>"Echo-Token: &lt;YOUR_TOKEN&gt;"
</code></pre>
<blockquote>
<p>For example, if you have stored your token in a file:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="s2">"Echo-Token: </span><span class="sb">`</span>cat /path/to/tokens/sit<span class="sb">`</span><span class="s2">"</span>
</code></pre><pre class="highlight clojure"><code><span class="w">
</span></code></pre>
<p>Both ECHO as well as URS/Earthdata Login tokens are supported.</p>

<p>Many of the examples in the documentation below show usage of the ECHO token.</p>
<h1 id='responses'>Responses</h1><h2 id='success'>Success</h2>
<p>CMR Service-Bridge responses have particular formats, inherited from CMR response
data. A successful request will provide the results, the number of results
and, the time taken to process the request.</p>

<blockquote>
<p>Successful response body:</p>
</blockquote>
<pre class="highlight plaintext"><code>{
  "hits": ...,
  "took": ...,
  "items": [...],
  "request-id": ...,
  "warnings:" null
}
</code></pre><h2 id='request-ids'>Request IDs</h2>
<p>Each request is given a random UUID to allow for better debugging and
correlation of events. In addition to being provided in the response body
for a successful query, the request ID is also sent in the response headers.
In the headers, the request ID has the field name <code>Cmr-Request-Id</code>.</p>

<blockquote>
<p>Example request ID in response headers:</p>
</blockquote>
<pre class="highlight plaintext"><code>HTTP/1.1 200 OK
Cmr-Took: 0.541
Cmr-Hits: 1
Content-Type: application/json
Cmr-Request-Id: 23713cac-5225-c29c-ca5a-f59d0982de8b
Cmr-Media-Type: cmr-service-bridge.v3; format=*
Access-Control-Allow-Origin: *
Content-Length: 170
Server: http-kit
Date: Mon, 26 Nov 2018 16:16:27 GMT
</code></pre><h2 id='errors'>Errors</h2>
<p>When CMR Service-Bridge returns errors, it does so in a consistent format. In
particular, the body of the HTTP response is a JSON string (or stream)
representing an object with one key, <code>errors</code>, an associated value being
an array of the errors encountered.</p>

<blockquote>
<p>CMR Service-Bridge error format</p>
</blockquote>
<pre class="highlight plaintext"><code>{
  "errors": [...]
}
</code></pre><h2 id='warnings'>Warnings</h2>
<p>In either a success or error state, CMR Service-Bridge may also return a <code>warning</code>
key containing one or more messages. This is reserved for future use and
will be the primary mechanism used to notify clients of coming changes in the
API that will impact users of the default version.</p>

<aside class="info">
  As a best practice, clients should check for and log any warning messages.
</aside>

<blockquote>
<p>Warnings sent in a successful response body:</p>
</blockquote>
<pre class="highlight plaintext"><code>{
  "hits": ...,
  "took": ...,
  "request-id": ...,
  "items": [...],
  "warnings": [...]
}
</code></pre>
<blockquote>
<p>Warnings sent in an error response body:</p>
</blockquote>
<pre class="highlight plaintext"><code>{
  "warnings": [...],
  "errors": [...]
}
</code></pre><h1 id='ous-resources'>OUS Resources</h1>
<p>This is the part of the REST API responsible for creating Service-Bridge-compatible
query URLs (intended to be sent to a deployed Service-Bridge service). The name
&quot;OUS&quot; (OPeNDAP URL Service) was used in the prototype for this service, and
that name has carried through here.</p>
<h2 id='tag-associations'>Tag Associations</h2>
<p>Currently, OUS depends upon CMR tag associations in order to map from a source file
(e.g., an HDF granule file) to a URL that represents an OPeNDAP service which supports
subsetting on that file. In other words, this allows OUS to convert a granule&#39;s archive
location to an OPeNDAP location.</p>

<blockquote>
<p>To map a granule&#39;s archive location to an OPeNDAP location, we first need to create a
tag using the tag key <code>cmr.earthdata.nasa.ous.datafile.replace</code>:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl --silent <span class="se">\</span>
     -XPOST <span class="se">\</span>
     -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
     -H <span class="s2">"Echo-Token: </span><span class="nv">$MY_TOKEN</span><span class="s2">"</span> <span class="se">\</span>
     <span class="s2">"%%BASE_URL%%search/tags </span><span class="se">\</span><span class="s2">
     -d {"</span>tag_key<span class="s2">" "</span>cmr.earthdata.nasa.ous.datafile.replace<span class="s2">", "</span>description<span class="s2">" "</span>This tag will provide a mapping from archive location to OPeNDAP location <span class="k">for </span>one or more collections<span class="s2">"}
</span></code></pre>
<blockquote>
<p>Then, we can associate the tag with the collection. We do this by using a regex that
replaces the archive location with the OPeNDAP location:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl --silent <span class="se">\</span>
     -XPOST <span class="se">\</span>
     -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
     -H <span class="s2">"Echo-Token: </span><span class="nv">$MY_TOKEN</span><span class="s2">"</span> <span class="se">\</span>
     <span class="s2">"%%BASE_URL%%search/tags/cmr.earthdata.nasa.ous.datafile.replace/associations </span><span class="se">\</span><span class="s2">
     -d '[{"</span>concept_id<span class="s2">": "</span>C1224363486-EEDTEST<span class="s2">",
           "</span>data<span class="s2">": {"</span>match<span class="s2">": "</span>/data//<span class="s2">", "</span>replace<span class="s2">": "</span>/opendap/<span class="s2">"}}]'
</span></code></pre>
<blockquote>
<p>Then, for any future OUS queries made to that collection and it&#39;s granules, OUS will
perform the substitution behind the scenes. This is demonstrated by the following query
to our tagged collection:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl <span class="se">\</span>
     -H <span class="s2">"Echo-Token: </span><span class="nv">$MY_TOKEN</span><span class="s2">"</span> <span class="se">\</span>
     <span class="s2">"%%BASE_URL%%service-bridge/ous/collection/C1224363486-EEDTEST?granules=G1224363487-EEDTEST
</span></code></pre><pre class="highlight shell tab-shell"><code><span class="o">{</span><span class="s2">"hits"</span>:1,
 <span class="s2">"took"</span>:0.244,
 <span class="s2">"items"</span>:[
   <span class="s2">"http://e4ftl01.cr.usgs.gov:40510/opendap/ASTT/AST_L1T.003/2001.11.29/AST_L1T_00311292001175440_20150303161825_63101.hdf.nc"</span><span class="o">]</span>,
 ...<span class="o">}</span>
</code></pre>
<blockquote>
<p>The returned results show the appropriate OPeNDAP URLS for the granule&#39;s archive location.</p>
</blockquote>
<h2 id='collection-resources'>Collection Resources</h2>
<p>The CMR Service-Bridge REST API supports two different means of creating a subsetted
OPeNDAP URL for granules and/or variables in a collection: one returns a
standard JSON document; the other, more effectual means returns a JSON document via HTTP streaming.</p>

<p>The resources are as follows:</p>

<ul>
<li><code>GET /service-bridge/ous/collection/:concept-id</code></li>
<li><code>GET /service-bridge/ous/streaming-collection/:concept-id</code></li>
</ul>

<blockquote>
<p>Example API usage if your client supports streaming:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl --silent <span class="se">\</span>
     -H <span class="s2">"Echo-Token: </span><span class="sb">`</span>cat ~/.cmr/tokens/sit<span class="sb">`</span><span class="s2">"</span> <span class="se">\</span>
     <span class="s2">"%%BASE_URL%%service-bridge/ous/streaming-collection/C1200187767-EDF_OPS"</span> | <span class="se">\</span>
     jq .
</code></pre>
<blockquote>
<p>Example API usage if your client doesn&#39;t support streaming:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl --silent <span class="se">\</span>
     -H <span class="s2">"Echo-Token: </span><span class="sb">`</span>cat ~/.cmr/tokens/sit<span class="sb">`</span><span class="s2">"</span> <span class="se">\</span>
     <span class="s2">"%%BASE_URL%%service-bridge/ous/collection/C1200187767-EDF_OPS"</span> | <span class="se">\</span>
     jq .
</code></pre>
<blockquote>
<p>Both of which return the same result:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="o">{</span>
  <span class="s2">"hits"</span>: 2,
  <span class="s2">"took"</span>: 0.621,
  <span class="s2">"items"</span>: <span class="o">[</span>
    <span class="s2">"https://acdisc.gesdisc.eosdis.nasa.gov/opendap/Aqua_AIRS_Level3/AIRX3STD.006..."</span>
  <span class="o">]</span>
<span class="o">}</span>
</code></pre>
<p>Both take the same parameters; the second one takes better, more efficient
advantage of system resources (micro-threads and OS threads). In particular,
the second one avoids making blocking calls in the request-processing thread;
as such, we recommend that this resource be preferred. The only requirement is
that your HTTP client supports streaming.</p>
<h2 id='interaction-of-parameters'>Interaction of Parameters</h2>
<p>In each sections below, the various parameters one can pass to the OUS resource
are described. Each parameter is discussed in isolation, simply addressing it
in its own context. However, common usage will involve more than one parameter
acting at the same time. As such, here are some points to note:</p>

<ul>
<li>Currently CMR Service-Bridge supports only queries with one collection; as such,
the collection query to CMR Search explicitly limits the results to one
with the <code>page_size=1</code> parameter.</li>
<li>When multiple variable concept ids are passed, these are sent to CMR Search
in a single query for efficiency (as opposed to sending one variable request
at a time).</li>
<li>Similarly, multiple granules are queried at once with a single query to CMR
Search.</li>
<li>In the granule query to CMR Search, spatial and temporal parameters that
were passed to CMR Service-Bridge will be used to limit the granule results from
CMR Search to just those in which the user is interested.</li>
</ul>
<h2 id='cmr-style-parameters'>CMR-Style Parameters</h2>
<p>The example above will generate a URL for downloading all the granules and all
the variables across the globe for the given collection. To limit these, there
are various parameters supported:</p>

<ul>
<li><code>bounding-box</code></li>
<li><code>exclude-granules</code></li>
<li><code>format</code></li>
<li><code>dap-version</code></li>
<li><code>granules</code></li>
<li><code>temporal</code></li>
<li><code>variables</code></li>
<li><code>page-size</code></li>
<li><code>page-num</code></li>
</ul>

<p>These may be used alone or in any combination. Details for usage are provided
below in separate sections.</p>

<p>Note that both hyphens and underscores are supported in parameters that have
them; you may use either, per your preference.</p>
<h3 id='bounding-box'><code>bounding-box</code></h3>
<p>This provides clients with the ability to select the spatial data to include
in the granule data extracted by the OPeNDAP query to an area of interest.</p>

<p>If not provided, the entire spatial extent of the granule will be used.</p>

<p>The following are examples of accepted <code>bounding-box</code> parameter usage,
note the acceptance of either dash or underscore in the parameter name:</p>

<ul>
<li><code>bounding-box=-9.984375,56.109375,19.828125,67.640625</code></li>
<li><code>bounding_box=-9.984375,56.109375,19.828125,67.640625</code></li>
</ul>

<blockquote>
<p>Use of <code>bounding-box</code> in a query:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -H <span class="s2">"Echo-Token: </span><span class="sb">`</span>cat ~/.cmr/tokens/sit<span class="sb">`</span><span class="s2">"</span> <span class="se">\</span>
     <span class="s2">"%%BASE_URL%%service-bridge/ous/collection/C1200187767-EDF_OPS?
     variables=V1200241812-EDF_OPS,V1200241817-EDF_OPS&amp;
     bounding-box=-9.984375,56.109375,19.828125,67.640625"</span>
</code></pre>
<p>Note that spatial subsetting on non-gridded data is not supported. If
<code>bounding-box</code> is provided against a collection whose granules
are not gridded, the spatial subsetting information will be dropped and one
or more warning messages will be returned in the payload.</p>
<h3 id='exclude-granules'><code>exclude-granules</code></h3>
<p>This allows clients to perform the inverse of a granule search. If the
value of this parameter is set to <code>&quot;true&quot;</code>, then all granules <em>except</em>
the ones passed will be returned.</p>

<p>If not provided, a regular granule search is performed.</p>

<p>The following are examples of accepted <code>exclude-granules</code> parameter usage,
note the acceptance of either dash or underscore in the parameter name:</p>

<ul>
<li><code>exclude-granules=true&amp;granules=G1200187775-EDF_OPS</code></li>
<li><code>exclude_granules=true&amp;granules=G1200187775-EDF_OPS</code></li>
</ul>

<p>Note that the <code>granules</code> parameter here may take any of the accepted forms
shown in the <code>granules</code> section below.</p>

<blockquote>
<p>Use of <code>exclude-granules</code> in a query:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -H <span class="s2">"Echo-Token: </span><span class="sb">`</span>cat ~/.cmr/tokens/sit<span class="sb">`</span><span class="s2">"</span> <span class="se">\</span>
     <span class="s2">"%%BASE_URL%%service-bridge/ous/collection/C1200187767-EDF_OPS?
     exclude-granules=true&amp;
     granules=G1200187775-EDF_OPS"</span>
</code></pre><h3 id='format'><code>format</code></h3>
<p>This allows the client to ask OPeNDAP to provide files in the given format.</p>

<p>If not provided, the default of <code>nc</code> (NetCDF) is used. Supported formats
depend upon the target OPeNDAP server.</p>

<p>The following is an example of accepted <code>format</code> parameter usage:</p>

<ul>
<li><code>format=nc</code></li>
</ul>

<blockquote>
<p>Use of <code>format</code> in a query:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -H <span class="s2">"Echo-Token: </span><span class="sb">`</span>cat ~/.cmr/tokens/sit<span class="sb">`</span><span class="s2">"</span> <span class="se">\</span>
     <span class="s2">"%%BASE_URL%%service-bridge/ous/collection/C1200187767-EDF_OPS?format=nc"</span>
</code></pre><h3 id='dap-version'><code>dap-version</code></h3>
<p>This allows the client to request OPeNDAP links in <a href="https://docs.opendap.org/index.php/DAP4:_Specification_Volume_1">DAP4</a> or <a href="https://earthdata.nasa.gov/esdis/esco/standards-and-references/data-access-protocol-2">DAP2</a> format.</p>

<p><code>dap-version</code> is supported since API v3. It will be ignored when used with API versions before v3.</p>

<p>The valid values of <code>dap-version</code> parameter is either 4 or 2. If not provided, the default value of <code>4</code> (DAP4) is used.</p>

<p>The following is an example of accepted <code>dap-version</code> parameter usage:</p>

<ul>
<li><code>dap-version=2</code></li>
</ul>

<blockquote>
<p>Use of <code>dap-version</code> in a query:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -H <span class="s2">"Echo-Token: </span><span class="sb">`</span>cat ~/.cmr/tokens/sit<span class="sb">`</span><span class="s2">"</span> <span class="se">\</span>
     <span class="s2">"%%BASE_URL%%service-bridge/ous/collection/C1200187767-EDF_OPS?dap-version=2"</span>
</code></pre><h3 id='granules'><code>granules</code></h3>
<p>This allows the client to select the granules to include (or exclude) in their
OPeNDAP queries.</p>

<p>If not provided, all granules for the given collection will be used. If used
in conjunction with the <code>exclude-granules</code> parameter, then all granules
<em>except</em> the ones passed will be used in the OPeNDAP query.</p>

<p>The following are examples of accepted <code>granules</code> parameter usage:</p>

<ul>
<li><code>granules=G1200187775-EDF_OPS</code></li>
<li><code>granules=G1200187775-EDF_OPS,G1200245955-EDF_OPS</code></li>
<li><code>granules=G1200187775-EDF_OPS&amp;granules=G1200245955-EDF_OPS</code></li>
<li><code>granules[]=G1200187775-EDF_OPS&amp;granules[]=G1200245955-EDF_OPS</code></li>
</ul>

<blockquote>
<p>Use of <code>granules</code> in a query:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -H <span class="s2">"Echo-Token: </span><span class="sb">`</span>cat ~/.cmr/tokens/sit<span class="sb">`</span><span class="s2">"</span> <span class="se">\</span>
     <span class="s2">"%%BASE_URL%%service-bridge/ous/collection/C1200187767-EDF_OPS?
     granules=G1200187775-EDF_OPS,G1200245955-EDF_OPS"</span>
</code></pre><h3 id='temporal'><code>temporal</code></h3>
<p>This provides clients with the ability to select a temporal subset of data to
include in the granule data extracted by the OPeNDAP query, only providing data
for the time of interest.</p>

<p>If not provided, the entire temporal extent of the granule will be used.</p>

<p>The following are examples of accepted <code>temporal</code> parameter usage:</p>

<ul>
<li><code>temporal=2002-09-01T00:00:00Z,2016-07-03T00:00:00Z</code></li>
<li><code>temporal[]=2002-09-01T00:00:00Z,2016-07-03T00:00:00Z</code></li>
<li><code>temporal=2000-01-01T00:00:00Z,2002-10-01T00:00:00Z&amp;temporal=2010-07-01T00:00:00Z,2016-07-03T00:00:00Z</code></li>
<li><code>temporal[]=2000-01-01T00:00:00Z,2002-10-01T00:00:00Z&amp;temporal[]=2010-07-01T00:00:00Z,2016-07-03T00:00:00Z</code></li>
</ul>

<blockquote>
<p>Use of <code>temporal</code> in a query:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -H <span class="s2">"Echo-Token: </span><span class="sb">`</span>cat ~/.cmr/tokens/sit<span class="sb">`</span><span class="s2">"</span> <span class="se">\</span>
     <span class="s2">"%%BASE_URL%%service-bridge/ous/collection/C1200187767-EDF_OPS?
     variables=V1200241812-EDF_OPS,V1200241817-EDF_OPS&amp;
     temporal=2002-09-01T00:00:00Z,2016-07-03T00:00:00Z"</span>
</code></pre><h3 id='variables'><code>variables</code></h3>
<p>This provides clients with the ability to limit the granule data extracted
by the OPeNDAP query to just the variables in which you are interested.</p>

<p>If not provided, all variables associated in the collection metadata will
be used.</p>

<p>The following are examples of accepted <code>variables</code> parameter usage:</p>

<ul>
<li><code>variables=V1200241812-EDF_OPS</code></li>
<li><code>variables=V1200241812-EDF_OPS,V1200241817-EDF_OPS</code></li>
<li><code>variables=V1200241812-EDF_OPS&amp;variables=V1200241817-EDF_OPS</code></li>
<li><code>variables[]=V1200241812-EDF_OPS&amp;variables[]=V1200241817-EDF_OPS</code></li>
</ul>

<blockquote>
<p>Use of <code>variables</code> in a query:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -H <span class="s2">"Echo-Token: </span><span class="sb">`</span>cat ~/.cmr/tokens/sit<span class="sb">`</span><span class="s2">"</span> <span class="se">\</span>
     <span class="s2">"%%BASE_URL%%service-bridge/ous/collection/C1200187767-EDF_OPS?
     variables=V1200241812-EDF_OPS,V1200241817-EDF_OPS"</span>
</code></pre><h3 id='page-size'><code>page-size</code></h3>
<p>Number of results per page - default is 10, max is 2000
The following are examples of accepted <code>page-size</code> parameter usage:</p>

<ul>
<li><code>page-size=5</code></li>
<li><code>page_size=5</code></li>
</ul>
<h3 id='page-num'><code>page-num</code></h3>
<p>The page number to return</p>

<p>The following are examples of accepted <code>page-num</code> parameter usage:</p>

<ul>
<li><code>page-num=2</code></li>
<li><code>page_num=2</code></li>
</ul>
<h2 id='wcs-style-parameters'>WCS-Style Parameters</h2>
<p>The original implementation of the OPeNDAP URL translation service was not a
part of the CMR, and thus did not take into consideration the internal
standards adopted by both the CMR and EDSC code bases. Instead, it was
decided to follow the model of
<a href="http://mapserver.org/ogc/wcs_server.html#wcs-2-0-kvp-request-parameters">WCS</a>.
As such, the following parameters are also available, as an alternative to the
&quot;classic&quot; CMR/EDSC parameters:</p>

<ul>
<li><code>coverage</code></li>
<li><code>format</code></li>
<li><code>dap-version</code></li>
<li><code>rangesubset</code></li>
<li><code>subset</code></li>
<li><code>timeposition</code></li>
<li><code>page-size</code></li>
<li><code>page-num</code></li>
</ul>

<p>These are show in more detail in the sub-sections below.</p>

<p>Note that WCS-style and CMR/EDSC-style parameters may not be mixed in the same
request; you must chose one or the other, not both.</p>
<h3 id='coverage'><code>coverage</code></h3>
<p>This allows the client to select the granules to include (or exclude) in their
OPeNDAP queries.</p>

<p>If not provided, all granules for the given collection will be used.</p>

<p>The following are examples of accepted <code>coverage</code> parameter usage:</p>

<ul>
<li><code>coverage=G1200187775-EDF_OPS</code></li>
<li><code>coverage=G1200187775-EDF_OPS,G1200245955-EDF_OPS</code></li>
</ul>

<blockquote>
<p>Use of <code>coverage</code> in a query:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -H <span class="s2">"Echo-Token: </span><span class="sb">`</span>cat ~/.cmr/tokens/sit<span class="sb">`</span><span class="s2">"</span> <span class="se">\</span>
     <span class="s2">"%%BASE_URL%%service-bridge/ous/collection/C1200187767-EDF_OPS?
     coverage=G1200187775-EDF_OPS,G1200245955-EDF_OPS"</span>
</code></pre><h3 id='format-2'><code>format</code></h3>
<p>This allows the client to ask OPeNDAP to provide files in the given format.</p>

<p>If not provided, the default of <code>nc</code> (NetCDF) is used. Supported formats
depend upon the target OPeNDAP server.</p>

<p>The following is an example of accepted <code>format</code> parameter usage:</p>

<ul>
<li><code>format=nc</code></li>
</ul>

<blockquote>
<p>Use of <code>format</code> in a query:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -H <span class="s2">"Echo-Token: </span><span class="sb">`</span>cat ~/.cmr/tokens/sit<span class="sb">`</span><span class="s2">"</span> <span class="se">\</span>
     <span class="s2">"%%BASE_URL%%service-bridge/ous/collection/C1200187767-EDF_OPS?format=nc"</span>
</code></pre><h3 id='dap-version-2'><code>dap-version</code></h3>
<p>This allows the client to request OPeNDAP links in <a href="https://docs.opendap.org/index.php/DAP4:_Specification_Volume_1">DAP4</a> or <a href="https://earthdata.nasa.gov/esdis/esco/standards-and-references/data-access-protocol-2">DAP2</a> format.</p>

<p><code>dap-version</code> is supported since API v3. It will be ignored when used with API versions before v3.</p>

<p>The valid values of <code>dap-version</code> parameter is either 4 or 2. If not provided, the default value of <code>4</code> (DAP4) is used.</p>

<p>The following is an example of accepted <code>dap-version</code> parameter usage:</p>

<ul>
<li><code>dap-version=2</code></li>
</ul>

<blockquote>
<p>Use of <code>dap-version</code> in a query:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -H <span class="s2">"Echo-Token: </span><span class="sb">`</span>cat ~/.cmr/tokens/sit<span class="sb">`</span><span class="s2">"</span> <span class="se">\</span>
     <span class="s2">"%%BASE_URL%%service-bridge/ous/collection/C1200187767-EDF_OPS?dap-version=2"</span>
</code></pre><h3 id='rangesubset'><code>rangesubset</code></h3>
<p>This provides clients with the ability to limit the granule data extracted
by the OPeNDAP query to just the variables in which you are interested.</p>

<p>If not provided, all variables associated in the collection metadata will
be used.</p>

<p>The following are examples of accepted <code>rangesubset</code> parameter usage:</p>

<ul>
<li><code>rangesubset=V1200241812-EDF_OPS</code></li>
<li><code>rangesubset=V1200241812-EDF_OPS,V1200241817-EDF_OPS</code></li>
</ul>

<blockquote>
<p>Use of <code>rangesubset</code> in a query:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -H <span class="s2">"Echo-Token: </span><span class="sb">`</span>cat ~/.cmr/tokens/sit<span class="sb">`</span><span class="s2">"</span> <span class="se">\</span>
     <span class="s2">"%%BASE_URL%%service-bridge/ous/collection/C1200187767-EDF_OPS?
     rangesubset=V1200241812-EDF_OPS,V1200241817-EDF_OPS"</span>
</code></pre><h3 id='subset'><code>subset</code></h3>
<p>This provides clients with the ability to select the spatial data to include
in the granule data extracted by the OPeNDAP query to an area of interest.</p>

<p>If not provided, the entire spatial extent of the granule will be used.</p>

<p>The following are examples of accepted <code>subset</code> parameter usage:</p>

<ul>
<li><code>subset=lat(56.109375,67.640625)</code></li>
<li><code>subset=lon(-9.984375,19.828125)</code></li>
</ul>

<p>Note that both are needed in order to define a bounding box.</p>

<blockquote>
<p>Use of <code>subset</code> in a query:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -H <span class="s2">"Echo-Token: </span><span class="sb">`</span>cat ~/.cmr/tokens/sit<span class="sb">`</span><span class="s2">"</span> <span class="se">\</span>
     <span class="s2">"%%BASE_URL%%service-bridge/ous/collection/C1200187767-EDF_OPS?
     variables=V1200241812-EDF_OPS,V1200241817-EDF_OPS&amp;
     subset=lat(56.109375,67.640625)&amp;subset=lon(-9.984375,19.828125)"</span>
</code></pre>
<p>Note that spatial subsetting on non-gridded data is not supported. If
<code>subset</code> is provided against a collection whose granules
are not gridded, the spatial subsetting information will be dropped and one
or more warning messages will be returned in the payload.</p>
<h3 id='timeposition'><code>timeposition</code></h3>
<p>This provides clients with the ability to select a temporal subset of data to
include in the granule data extracted by the OPeNDAP query, only providing data
for the time of interest.</p>

<p>If not provided, the entire temporal extent of the granule will be used.</p>

<p>The following is an example of accepted <code>timeposition</code> parameter usage:</p>

<ul>
<li><code>timeposition=2002-09-01T00:00:00Z,2016-07-03T00:00:00Z</code></li>
<li><code>timeposition=2000-01-01T00:00:00Z,2002-10-01T00:00:00Z&amp;timeposition=2010-07-01T00:00:00Z,2016-07-03T00:00:00Z</code></li>
</ul>

<blockquote>
<p>Use of <code>timeposition</code> in a query:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -H <span class="s2">"Echo-Token: </span><span class="sb">`</span>cat ~/.cmr/tokens/sit<span class="sb">`</span><span class="s2">"</span> <span class="se">\</span>
     <span class="s2">"%%BASE_URL%%service-bridge/ous/collection/C1200187767-EDF_OPS?
     variables=V1200241812-EDF_OPS,V1200241817-EDF_OPS&amp;
     timeposition=2002-09-01T00:00:00Z,2016-07-03T00:00:00Z"</span>
</code></pre><h3 id='page-size-2'><code>page-size</code></h3>
<p>Number of results per page - default is 10, max is 2000
The following are examples of accepted <code>page-size</code> parameter usage:</p>

<ul>
<li><code>page-size=5</code></li>
<li><code>page_size=5</code></li>
</ul>
<h3 id='page-num-2'><code>page-num</code></h3>
<p>The page number to return</p>

<p>The following are examples of accepted <code>page-num</code> parameter usage:</p>

<ul>
<li><code>page-num=2</code></li>
<li><code>page_num=2</code></li>
</ul>
<h2 id='forthcoming'>Forthcoming</h2>
<p>The following are coming soon:</p>

<ul>
<li><code>POST /service-bridge/ous/collection/:concept-id</code></li>
<li><code>POST /service-bridge/ous/collections</code></li>
</ul>
<h1 id='ses-resources'>SES Resources</h1><h2 id='collection-resources-2'>Collection Resources</h2>
<p>The Size Estimation Service offers a REST API for estimating the download sizes of subsetted
collection-based granule queries. The usage is almost identical to the OUS resources, the
primary different being the path segment:</p>

<ul>
<li><code>GET /service-bridge/size-estimate/collection/:concept-id</code></li>
</ul>
<h2 id='parameters'>Parameters</h2>
<p>Two parameters are required in a query string to this resource:</p>

<ul>
<li><code>granules</code> which is comma-separated for two or more granules, or <code>granules[]</code>,
which is repeated for each granule in the query string</li>
<li><code>variables(or variable_aliases)</code>  which is comma-separated for two or more variables(or variable-aliases),
or <code>variables[](or variable_aliases[]</code>, which is repeated for each variable(or variable_alias) in the query string.
Note: values for variable_aliases could be aliases or the group nodes of the aliases. Both <code>alias=&lt;alias&gt;</code>
and <code>alias=&lt;alias&gt;/*</code> are searched in CMR variable search to take both alias and group nodes into account.</li>
</ul>

<p>A <code>service_id</code> parameter is optional; if not provided, the service type of <code>opendap</code> is assumed.
otherwise, the service type will be retrieved using the service_id through OUS call to CMR.</p>

<p>A <code>format</code> parameter is optional; if not provided, the format of <code>nc</code> (NetCDF3) is assumed for
<code>opendap</code> service type and the format of <code>native</code> is assumed for <code>esi</code> service type.
Currently supported <code>format</code> values are (case insensitive):</p>

<p>For <code>opendap</code> service type:</p>

<ul>
<li><code>dods</code> (binary)</li>
<li><code>nc</code></li>
<li><code>nc4</code></li>
<li><code>ascii</code></li>
</ul>

<p>For <code>esi</code> service type:</p>

<ul>
<li><code>nc</code> (or <code>netcdf</code>)</li>
<li><code>nc4</code> (or <code>netcdf4-cf</code>,<code>netcdf4</code>,<code>netcdf-4</code>)</li>
<li><code>tabular_ascii</code></li>
<li><code>native</code></li>
<li><code>geotiff</code></li>
<li><code>shapefile</code></li>
</ul>

<p>All parameters behave as documented above in the OUS sections on <code>granules</code>, <code>variables</code>, and
<code>format</code>, so see those sections for more details.</p>

<p>A final parameter that is unique to the size estimation service is <code>total-granule-input-bytes</code>:
this is required when passing <code>nc4</code> or <code>ascii</code> as the format values. This parameter represents
the size of the granules when no subsetting operation is being performed.</p>
<h2 id='examples'>Examples</h2>
<p>Some example usage is given in the adjacent panel to the right; towards the bottom you will see
examples for spatial subsetting sizing estimates.</p>

<blockquote>
<p>Get a size estimate for one granule and one variable:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -H <span class="s2">"Echo-Token: </span><span class="sb">`</span>cat ~/.cmr/tokens/sit<span class="sb">`</span><span class="s2">"</span> <span class="se">\</span>
     <span class="s2">"%%BASE_URL%%service-bridge/size-estimate/collection/C1200288493-EDF_DEV01?
     granules=G1200288503-EDF_DEV01&amp;
     variables=V1200296418-EDF_DEV01"</span>
</code></pre>
<blockquote>
<p>Result:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="o">{</span>
  <span class="s2">"hits"</span>: 1,
  <span class="s2">"took"</span>: 0.595,
  <span class="s2">"items"</span>: <span class="o">[</span>
    <span class="o">{</span>
      <span class="s2">"bytes"</span>: 11526291,
      <span class="s2">"mb"</span>: 10.992327690124512,
      <span class="s2">"gb"</span>: 0.010734695009887218
    <span class="o">}</span>
  <span class="o">]</span>,
  <span class="s2">"warnings"</span>: null
<span class="o">}</span>
</code></pre>
<blockquote>
<p>Since we didn&#39;t provide a format, the default of <code>nc</code> is assumed.</p>

<p>Get a size estimate for one granule and multiple variables in DODS (binary) format:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -H <span class="s2">"Echo-Token: </span><span class="sb">`</span>cat ~/.cmr/tokens/sit<span class="sb">`</span><span class="s2">"</span> <span class="se">\</span>
     <span class="s2">"%%BASE_URL%%service-bridge/size-estimate/collection/C1200288493-EDF_DEV01?
     granules=G1200288503-EDF_DEV01&amp;
     variables=V1200296418-EDF_DEV01,V1200296176-EDF_DEV01,V1200296424-EDF_DEV01&amp;
     format=dods"</span>
</code></pre>
<blockquote>
<p>Result:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="o">{</span>
  <span class="s2">"hits"</span>: 1,
  <span class="s2">"took"</span>: 0.379,
  <span class="s2">"items"</span>: <span class="o">[</span>
    <span class="o">{</span>
      <span class="s2">"bytes"</span>: 40320000,
      <span class="s2">"mb"</span>: 38.4521484375,
      <span class="s2">"gb"</span>: 0.037550926208496094
    <span class="o">}</span>
  <span class="o">]</span>,
  <span class="s2">"warnings"</span>: null
<span class="o">}</span>
</code></pre>
<blockquote>
<p>Get a size estimate for multiple granules and multiple variables in DODS (binary) format:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -H <span class="s2">"Echo-Token: </span><span class="sb">`</span>cat ~/.cmr/tokens/sit<span class="sb">`</span><span class="s2">"</span> <span class="se">\</span>
     <span class="s2">"%%BASE_URL%%service-bridge/size-estimate/collection/C1200288493-EDF_DEV01?
     granules=G1200288503-EDF_DEV01,G1200288508-EDF_DEV01,G1200288512-EDF_DEV01&amp;
     variables=V1200296418-EDF_DEV01,V1200296176-EDF_DEV01,V1200296424-EDF_DEV01&amp;
     format=dods"</span>
</code></pre>
<blockquote>
<p>Result:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="o">{</span>
  <span class="s2">"hits"</span>: 1,
  <span class="s2">"took"</span>: 0.364,
  <span class="s2">"items"</span>: <span class="o">[</span>
    <span class="o">{</span>
      <span class="s2">"bytes"</span>: 120960000,
      <span class="s2">"mb"</span>: 115.3564453125,
      <span class="s2">"gb"</span>: 0.11265277862548828
    <span class="o">}</span>
  <span class="o">]</span>,
  <span class="s2">"warnings"</span>: null
<span class="o">}</span>
</code></pre>
<blockquote>
<p>And, as stated, if you prefer the array type parameters, you may use those as well
to the same effect:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -H <span class="s2">"Echo-Token: </span><span class="sb">`</span>cat ~/.cmr/tokens/sit<span class="sb">`</span><span class="s2">"</span> <span class="se">\</span>
     <span class="s2">"%%BASE_URL%%service-bridge/size-estimate/collection/C1200288493-EDF_DEV01?
     granules</span><span class="se">\[\]</span><span class="s2">=G1200288503-EDF_DEV01&amp;
     granules</span><span class="se">\[\]</span><span class="s2">=G1200288508-EDF_DEV01&amp;
     granules</span><span class="se">\[\]</span><span class="s2">=G1200288512-EDF_DEV01&amp;
     variables</span><span class="se">\[\]</span><span class="s2">=V1200296418-EDF_DEV01&amp;
     variables</span><span class="se">\[\]</span><span class="s2">=V1200296176-EDF_DEV01&amp;
     variables</span><span class="se">\[\]</span><span class="s2">=V1200296424-EDF_DEV01&amp;
     format=dods"</span>
</code></pre>
<blockquote>
<p>Result:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="o">{</span>
  <span class="s2">"hits"</span>: 1,
  <span class="s2">"took"</span>: 0.364,
  <span class="s2">"items"</span>: <span class="o">[</span>
    <span class="o">{</span>
      <span class="s2">"bytes"</span>: 120960000,
      <span class="s2">"mb"</span>: 115.3564453125,
      <span class="s2">"gb"</span>: 0.11265277862548828
    <span class="o">}</span>
  <span class="o">]</span>,
  <span class="s2">"warnings"</span>: null
<span class="o">}</span>
</code></pre>
<blockquote>
<p>For spatial subsetting, simply include the <code>bounding-box</code> parameter, per the
documentation above (see the &quot;bounding-box&quot; subheading in the &quot;OUS Resources&quot;
section):</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>

</code></pre><h1 id='admin-resources'>Admin Resources</h1><h2 id='cache'>Cache</h2>
<p>Administrative users may use a token to manage the authorization cache:</p>

<ul>
<li><code>GET    /service-bridge/cache/auth</code></li>
<li><code>DELETE /service-bridge/cache/auth</code></li>
<li><code>GET    /service-bridge/cache/auth/:item-key</code></li>
<li><code>DELETE /service-bridge/cache/auth/:item-key</code></li>
</ul>

<p>Likewise, administrators have the ability to manage the concept cache:</p>

<ul>
<li><code>GET    /service-bridge/cache/concept</code></li>
<li><code>DELETE /service-bridge/cache/concept</code></li>
<li><code>GET    /service-bridge/cache/concept/:item-key</code></li>
<li><code>DELETE /service-bridge/cache/concept/:item-key</code></li>
</ul>
<h2 id='health'>Health</h2>
<p>Even though the <code>health</code> resources are classified as &quot;admin&quot;, they are
available for use by anyone.</p>

<ul>
<li><code>GET     /service-bridge/health</code></li>
<li><code>OPTIONS /service-bridge/health</code></li>
</ul>
<h2 id='ping'>Ping</h2>
<p>Administrative users may use a token to access the following:</p>

<ul>
<li><code>GET     /service-bridge/ping</code></li>
<li><code>POST    /service-bridge/ping</code></li>
<li><code>OPTIONS /service-bridge/ping</code></li>
</ul>
<h1 id='testing-resources'>Testing Resources</h1>
<p>The following resources are provided for use in various tests:</p>

<ul>
<li><code>GET /testing/401</code></li>
<li><code>GET /testing/403</code></li>
<li><code>GET /testing/404</code></li>
<li><code>GET /testing/405</code></li>
<li><code>GET /testing/500</code></li>
<li><code>GET /testing/503</code></li>
</ul>
<h1 id='errors-messages'>Errors Messages</h1><h2 id='dependent-services'>Dependent Services</h2>
<p>CMR Service-Bridge will not only report its own errors, but errors encountered when
making calls to other services upon which it depends. Those errors are not
listed below, but will be appended to the array of errors in the response body.</p>
<h2 id='cmr-service-bridge-warnings'>CMR Service-Bridge Warnings</h2>
<p>Warning messages will generally be included in a successful response, and thus
will usually have an HTTP status of 200.</p>
<h3 id='gridded-data'>Gridded Data</h3>
<table><thead>
<tr>
<th>HTTP Status</th>
<th>Warning Message</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>The variables <em>__, _</em>_, ... are not gridded.</td>
</tr>
<tr>
<td>200</td>
<td>The bounding information for the query has been removed.</td>
</tr>
</tbody></table>
<h2 id='cmr-service-bridge-errors'>CMR Service-Bridge Errors</h2><h3 id='authorization'>Authorization</h3>
<table><thead>
<tr>
<th>HTTP Status</th>
<th>Error Message</th>
</tr>
</thead><tbody>
<tr>
<td>403</td>
<td>You do not have permissions to access that resource.</td>
</tr>
<tr>
<td>403</td>
<td>An ECHO token is required to access this resource.</td>
</tr>
</tbody></table>
<h3 id='url-generation'>URL Generation</h3><h4 id='client-side'>Client-Side</h4>
<table><thead>
<tr>
<th>HTTP Status</th>
<th>Error Message</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>The request includes a dataset whose processing level is not supported.</td>
</tr>
<tr>
<td>400</td>
<td>Problematic processing level ___ for collection ___.</td>
</tr>
<tr>
<td>400</td>
<td>The service pattern computed was empty. Is there a service associated with the given collection? Does the UMM-S record in question have values for the pattern fields?</td>
</tr>
<tr>
<td>400</td>
<td>One or more of the parameters provided were invalid.</td>
</tr>
<tr>
<td>400</td>
<td>The values provided for latitude are not within the valid range of -90 degrees through 90 degrees.</td>
</tr>
<tr>
<td>400</td>
<td>The values provided for longitude are not within the valid range of -180 degrees through 180 degrees.</td>
</tr>
</tbody></table>
<h4 id='server-side'>Server-Side</h4>
<table><thead>
<tr>
<th>HTTP Status</th>
<th>Error Message</th>
</tr>
</thead><tbody>
<tr>
<td>500</td>
<td>There was a problem extracting a service data file from the granule.</td>
</tr>
<tr>
<td>500</td>
<td>There was a problem creating URLs from granule file data: couldn&#39;t match default service pattern %s to service ___.</td>
</tr>
<tr>
<td>500</td>
<td>Problematic granules: [...].</td>
</tr>
<tr>
<td>500</td>
<td>There was a problem extracting a data URL from the granule&#39;s service data file.</td>
</tr>
<tr>
<td>500</td>
<td>There was a problem extracting granule metadata.</td>
</tr>
<tr>
<td>500</td>
<td>There was a problem extracting service metadata.</td>
</tr>
<tr>
<td>500</td>
<td>There was a problem extracting variable metadata.</td>
</tr>
</tbody></table>
<h3 id='general'>General</h3>
<table><thead>
<tr>
<th>HTTP Status</th>
<th>Error Message</th>
</tr>
</thead><tbody>
<tr>
<td>400-599</td>
<td>HTTP Error status code: ___.</td>
</tr>
<tr>
<td>400</td>
<td>This capability is not currently implemented.</td>
</tr>
<tr>
<td>400</td>
<td>This capability is not currently supported.</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
                <a href="#" data-language-name="javascript">javascript</a>
                <a href="#" data-language-name="clojure">clojure</a>
          </div>
      </div>
    </div>
  <script src="https://fbm.earthdata.nasa.gov/for/CMR/feedback.js"
          type="text/javascript"></script>
  </body>
</html>
